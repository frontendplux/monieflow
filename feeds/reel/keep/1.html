<!DOCTYPE html>
<html>
<head>
    <title>Record Video</title>
</head>
<body>

<video id="preview" autoplay muted></video>
<br>
<button onclick="startRecording()">Start</button>
<button onclick="stopRecording()">Stop</button>

<script>
let mediaRecorder;
let recordedChunks = [];

async function startRecording() {
    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    document.getElementById('preview').srcObject = stream;
    mediaRecorder = new MediaRecorder(stream);
    mediaRecorder.ondataavailable = event => {
        if (event.data.size > 0) {
            recordedChunks.push(event.data);
        }
    };

    mediaRecorder.start();
}

function stopRecording() {
    mediaRecorder.stop();
    mediaRecorder.onstop = () => {
        const blob = new Blob(recordedChunks, { type: 'video/webm' });
        uploadVideo(blob);
        recordedChunks = [];
    };
}

function uploadVideo(blob) {
    const formData = new FormData();
    formData.append("video", blob, "recorded.webm");

    fetch("upload.php", {
        method: "POST",
        body: formData
    })
    .then(res => res.text())
    .then(data => alert(data));
}
</script>

</body>
</html>
